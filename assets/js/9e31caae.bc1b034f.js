"use strict";(globalThis.webpackChunkknowledge_core=globalThis.webpackChunkknowledge_core||[]).push([[6507],{2192:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>o,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"essential-dev-utils/aws/aws-cloudwatch","title":"AWS - CloudWatch","description":"This document provides useful queries for AWS CloudWatch logs to filter and sort error messages.","source":"@site/docs/essential-dev-utils/aws/aws-cloudwatch.md","sourceDirName":"essential-dev-utils/aws","slug":"/essential-dev-utils/aws/aws-cloudwatch","permalink":"/knowledge-core/docs/essential-dev-utils/aws/aws-cloudwatch","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/essential-dev-utils/aws/aws-cloudwatch.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"AWS - CloudWatch","sidebar_label":"AWS - CloudWatch"},"sidebar":"tutorialSidebar","previous":{"title":"AWS","permalink":"/knowledge-core/docs/category/aws"},"next":{"title":"New Relic","permalink":"/knowledge-core/docs/category/new-relic"}}');var i=t(4848),l=t(8453);const a={sidebar_position:1,title:"AWS - CloudWatch",sidebar_label:"AWS - CloudWatch"},r="AWS Cloud Watch",o={},c=[{value:"Query for Uncaught Exceptions",id:"query-for-uncaught-exceptions",level:2},{value:"Explanation",id:"explanation",level:3},{value:"Filter Log Messages and Count Matches",id:"filter-log-messages-and-count-matches",level:2},{value:"Explanation",id:"explanation-1",level:3},{value:"Count Messages and Calculate Size",id:"count-messages-and-calculate-size",level:2},{value:"Explanation",id:"explanation-2",level:3},{value:"Group Errors by Stacktrace",id:"group-errors-by-stacktrace",level:2},{value:"Explanation",id:"explanation-3",level:3}];function d(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"aws-cloud-watch",children:"AWS Cloud Watch"})}),"\n",(0,i.jsx)(s.p,{children:"This document provides useful queries for AWS CloudWatch logs to filter and sort error messages."}),"\n",(0,i.jsx)(s.h2,{id:"query-for-uncaught-exceptions",children:"Query for Uncaught Exceptions"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-sql",children:"fields @timestamp, @message, @logStream, @log\n| filter @message like 'uncaughtException'\n| sort @timestamp desc\n| limit 10000\n"})}),"\n",(0,i.jsx)(s.h3,{id:"explanation",children:"Explanation"}),"\n",(0,i.jsx)(s.p,{children:"This query retrieves log entries containing the term 'uncaughtException'. Here\u2019s a breakdown of the command:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"fields @timestamp, @message, @logStream, @log"}),": Specifies the fields to be displayed in the results."]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"@timestamp"}),": The time when the log entry was created."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"@message"}),": The content of the log entry."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"@logStream"}),": The stream from which the log entry originates."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"@log"}),": The log group associated with the entry."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"filter @message like 'uncaughtException'"}),": Filters the log entries to include only those that contain the specified term."]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"sort @timestamp desc"}),": Sorts the results by timestamp in descending order, showing the most recent entries first."]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"limit 10000"}),": Limits the number of returned entries to 10,000."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"filter-log-messages-and-count-matches",children:"Filter Log Messages and Count Matches"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-sql",children:"fields @timestamp, @message\n| filter @message like 'SOME_ERROR'\n| stats count() as total_matches\n"})}),"\n",(0,i.jsx)(s.h3,{id:"explanation-1",children:"Explanation"}),"\n",(0,i.jsx)(s.p,{children:"This command filters log messages to identify occurrences of a specific error and counts the total matches. Below is a breakdown of the command:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"fields @timestamp, @message"}),": Specifies the fields to include in the output, in this case, the timestamp and message."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"filter @message like 'SOME_ERROR'"}),': Filters log messages that contain the string "SOME_ERROR".']}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"stats count() as total_matches"}),": Aggregates the filtered results and provides the count of occurrences, labeling the output as ",(0,i.jsx)(s.code,{children:"total_matches"}),"."]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"count-messages-and-calculate-size",children:"Count Messages and Calculate Size"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-sql",children:"fields @message\n| stats count (*) as total, sum(strlen(@message))/1024/1024 as size by label, level, message\n| sort by size desc\n"})}),"\n",(0,i.jsx)(s.h3,{id:"explanation-2",children:"Explanation"}),"\n",(0,i.jsx)(s.p,{children:"This query counts the total number of messages and calculates their size, grouped by specific labels, levels, and messages. The following components detail the query's functionality:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"fields @message"}),": Specifies the field to analyze, which in this case is the message content."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"stats count (*) as total"}),": Computes the total count of messages and labels it as ",(0,i.jsx)(s.code,{children:"total"}),"."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"sum(strlen(@message))/1024/1024 as size"}),": Calculates the total size of messages in megabytes by summing the length of each message and converting the result from bytes to megabytes."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"by label, level, message"}),": Groups the results based on the specified fields: ",(0,i.jsx)(s.code,{children:"label"}),", ",(0,i.jsx)(s.code,{children:"level"}),", and ",(0,i.jsx)(s.code,{children:"message"}),"."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"sort by size desc"}),": Orders the output by message size in descending order, allowing for easy identification of the largest messages."]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"group-errors-by-stacktrace",children:"Group Errors by Stacktrace"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-sql",children:'filter @message like "error"\n| stats count(*) as total by stacktrace\n| sort total desc\n'})}),"\n",(0,i.jsx)(s.h3,{id:"explanation-3",children:"Explanation"}),"\n",(0,i.jsx)(s.p,{children:'This query identifies the most frequent errors by filtering messages containing the term "error" and grouping them by their stacktrace. Here\u2019s a breakdown of the command:'}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:'filter @message like "error"'}),': Filters the log entries to include only those that contain the string "error".']}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"stats count(*) as total by stacktrace"}),": Aggregates the filtered results by counting the occurrences of each unique stacktrace and labeling the count as ",(0,i.jsx)(s.code,{children:"total"}),"."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"sort total desc"}),": Sorts the results by the total count in descending order, making it easy to spot the most recurring exceptions."]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,l.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,s,t)=>{t.d(s,{R:()=>a,x:()=>r});var n=t(6540);const i={},l=n.createContext(i);function a(e){const s=n.useContext(l);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function r(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),n.createElement(l.Provider,{value:s},e.children)}}}]);