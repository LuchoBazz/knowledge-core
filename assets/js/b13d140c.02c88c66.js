"use strict";(self.webpackChunkknowledge_core=self.webpackChunkknowledge_core||[]).push([[4433],{1108:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>l});var s=n(4848),r=n(8453);const a={sidebar_position:1,sidebar_label:"Long-Running Query Pattern"},o="Long-Running Query Pattern",i={id:"essential-dev-utils/software-architecture/long-running-query-pattern",title:"Long-Running Query Pattern",description:"Step 1: Initiate the Import",source:"@site/docs/essential-dev-utils/software-architecture/long-running-query-pattern.md",sourceDirName:"essential-dev-utils/software-architecture",slug:"/essential-dev-utils/software-architecture/long-running-query-pattern",permalink:"/knowledge-core/docs/essential-dev-utils/software-architecture/long-running-query-pattern",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/essential-dev-utils/software-architecture/long-running-query-pattern.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,sidebar_label:"Long-Running Query Pattern"},sidebar:"tutorialSidebar",previous:{title:"Software Architecture",permalink:"/knowledge-core/docs/category/software-architecture"},next:{title:"Database",permalink:"/knowledge-core/docs/category/database"}},c={},l=[{value:"Step 1: Initiate the Import",id:"step-1-initiate-the-import",level:3},{value:"Step 2: Check the Status",id:"step-2-check-the-status",level:3},{value:"Steps to Implement This Pattern",id:"steps-to-implement-this-pattern",level:2},{value:"1. Initiate Import (Asynchronous Phase)",id:"1-initiate-import-asynchronous-phase",level:3},{value:"2. Polling the Import Status",id:"2-polling-the-import-status",level:3},{value:"Task State Storage",id:"task-state-storage",level:2},{value:"<code>tasks</code> Table",id:"tasks-table",level:3},{value:"<code>task_progress</code> Table",id:"task_progress-table",level:3},{value:"Sample Payload",id:"sample-payload",level:3}];function d(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"long-running-query-pattern",children:"Long-Running Query Pattern"})}),"\n",(0,s.jsx)(t.h3,{id:"step-1-initiate-the-import",children:"Step 1: Initiate the Import"}),"\n",(0,s.jsx)(t.p,{children:"The client makes a request to initiate the import of records, which returns an identifier (ID) that can be used to check the status of the import."}),"\n",(0,s.jsx)(t.h3,{id:"step-2-check-the-status",children:"Step 2: Check the Status"}),"\n",(0,s.jsx)(t.p,{children:"The client can periodically make requests to check the operation's status using the provided ID until the import is complete."}),"\n",(0,s.jsx)(t.h2,{id:"steps-to-implement-this-pattern",children:"Steps to Implement This Pattern"}),"\n",(0,s.jsx)(t.h3,{id:"1-initiate-import-asynchronous-phase",children:"1. Initiate Import (Asynchronous Phase)"}),"\n",(0,s.jsx)(t.p,{children:"When the client initiates the import, the API should return a task ID that can be used to track progress. The actual import process should run in the background so that the REST API does not block the response while the import is ongoing."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Request:"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-http",children:"POST /api/tools/import\n"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Body:"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-json",children:'{\n  "data": [\n    {\n      "tool_name": "University Scraper",\n      "tool_id": "V001",\n      "category": "Education",\n      "description": "Extracts data on requirements, fees, and programs from Russian universities to keep budget information up-to-date.",\n      "features": ["Data extraction", "Requirement updates", "Program information", "Fee updates"],\n      "url": "https://example.com/university-scraper"\n    },\n    {\n      "tool_name": "Currency Converter",\n      "tool_id": "V002",\n      "category": "Finance",\n      "description": "Calculates real-time exchange rates to convert prices in your budget across various currencies.",\n      "features": ["Real-time rates", "Multiple currencies", "Conversion history"],\n      "url": "https://example.com/currency-converter"\n    },\n    {\n      "tool_name": "Study Cost Simulator",\n      "tool_id": "V003",\n      "category": "Education",\n      "description": "Estimates the total cost of studying in various Russian cities, accounting for tuition, accommodation, and other expenses.",\n      "features": ["Tuition cost estimation", "Accommodation costs", "Other expenses", "City comparison"],\n      "url": "https://example.com/study-cost-simulator"\n    }\n  ]\n}\n'})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Response:"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-json",children:'{\n  "task_reference": "HD6EKSD8DO9",\n  "status": "IN_PROGRESS"\n}\n'})}),"\n",(0,s.jsx)(t.h3,{id:"2-polling-the-import-status",children:"2. Polling the Import Status"}),"\n",(0,s.jsxs)(t.p,{children:["The client uses the ",(0,s.jsx)(t.code,{children:"task_reference"})," to periodically check the status of the process. The response should include the current status of the import and, once complete, details about the result."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Request:"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-http",children:"GET /api/tools/import/status/HD6EKSD8DO9\n"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Response:"})}),"\n",(0,s.jsx)(t.p,{children:"If the process is ongoing:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-json",children:'{\n  "task_reference": "HD6EKSD8DO9",\n  "status": "IN_PROGRESS",\n  "progress": "45%"\n}\n'})}),"\n",(0,s.jsx)(t.p,{children:"If the process is complete:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-json",children:'{\n  "task_reference": "HD6EKSD8DO9",\n  "status": "COMPLETED",\n  "progress": "100%",\n  "imported_records": 1000,\n  "errors": []\n}\n'})}),"\n",(0,s.jsx)(t.p,{children:"If the process has failed:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-json",children:'{\n  "task_reference": "HD6EKSD8DO9",\n  "status": "COMPLETED",\n  "progress": "100%",\n  "imported_records": 5,\n  "errors": [\n    {\n      "tool_name": "Currency Converter",\n      "tool_id": "V002",\n      "category": "Finance",\n      "description": "Calculates real-time exchange rates to convert prices in your budget across various currencies.",\n      "features": ["Real-time rates", "Multiple currencies", "Conversion history"],\n      "url": "https://example.com/currency-converter"\n    },\n    {\n      "tool_name": "Study Cost Simulator",\n      "tool_id": "V003",\n      "category": "Education",\n      "description": "Estimates the total cost of studying in various Russian cities, accounting for tuition, accommodation, and other expenses.",\n      "features": ["Tuition cost estimation", "Accommodation costs", "Other expenses", "City comparison"],\n      "url": "https://example.com/study-cost-simulator"\n    }\n  ]\n}\n'})}),"\n",(0,s.jsx)(t.h2,{id:"task-state-storage",children:"Task State Storage"}),"\n",(0,s.jsxs)(t.h3,{id:"tasks-table",children:[(0,s.jsx)(t.code,{children:"tasks"})," Table"]}),"\n",(0,s.jsx)(t.p,{children:"This table will contain one row per initiated task, with details about its current status."}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sql",children:"CREATE TABLE IF NOT EXISTS xforce.tasks (\n  task_id             UUID NOT NULL,\n  task_reference      VARCHAR(32) NOT NULL, -- e.g., HD6EKSD8DO9\n  task_name           VARCHAR(255),\n  status              VARCHAR(50) NOT NULL,\n  progress            INT DEFAULT 0,\n  total_records       INT DEFAULT 0,\n  imported_records    INT DEFAULT 0,\n  failed_records      INT DEFAULT 0,\n  error_message       TEXT,\n  is_active           BOOLEAN NOT NULL DEFAULT TRUE,\n  created_at          TIMESTAMP DEFAULT NOW(),\n  updated_at          TIMESTAMP DEFAULT NOW(),\n  CONSTRAINT tasks_pk PRIMARY KEY (task_id)\n);\n"})}),"\n",(0,s.jsxs)(t.h3,{id:"task_progress-table",children:[(0,s.jsx)(t.code,{children:"task_progress"})," Table"]}),"\n",(0,s.jsx)(t.p,{children:"This table stores the progress of each task."}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sql",children:"CREATE TABLE IF NOT EXISTS xforce.task_progress (\n  progress_id        UUID NOT NULL,\n  task_id            UUID NOT NULL REFERENCES tasks(task_id),\n  status             VARCHAR(50) NOT NULL, -- e.g., COMPLETED, FAILED\n  record             JSONB NOT NULL, -- Record details in JSON format\n  created_at         TIMESTAMP DEFAULT NOW(),\n  CONSTRAINT task_progress_pk PRIMARY KEY (progress_id)\n);\n"})}),"\n",(0,s.jsx)(t.h3,{id:"sample-payload",children:"Sample Payload"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-json",children:'[\n  {\n    "tool_name": "University Scraper",\n    "tool_id": "V001",\n    "category": "Education",\n    "description": "Extracts data on requirements, fees, and programs from Russian universities to keep budget information up-to-date.",\n    "features": ["Data extraction", "Requirement updates", "Program information", "Fee updates"],\n    "url": "https://example.com/university-scraper"\n  },\n  {\n    "tool_name": "Currency Converter",\n    "tool_id": "V002",\n    "category": "Finance",\n    "description": "Calculates real-time exchange rates to convert prices in your budget across various currencies.",\n    "features": ["Real-time rates", "Multiple currencies", "Conversion history"],\n    "url": "https://example.com/currency-converter"\n  },\n  {\n    "tool_name": "Study Cost Simulator",\n    "tool_id": "V003",\n    "category": "Education",\n    "description": "Estimates the total cost of studying in various Russian cities, accounting for tuition, accommodation, and other expenses.",\n    "features": ["Tuition cost estimation", "Accommodation costs", "Other expenses", "City comparison"],\n    "url": "https://example.com/study-cost-simulator"\n  },\n  {\n    "tool_name": "Vocabulary Flashcard Generator",\n    "tool_id": "V004",\n    "category": "Language Learning",\n    "description": "Practice essential Russian vocabulary for daily life and studies in Russia using digital flashcards.",\n    "features": ["Custom vocabulary sets", "Review schedules", "Digital flashcards"],\n    "url": "https://example.com/vocabulary-flashcard-generator"\n  },\n  {\n    "tool_name": "Travel and Route Planner",\n    "tool_id": "V005",\n    "category": "Travel",\n    "description": "Calculates and optimizes routes within Russia, considering travel time and costs.",\n    "features": ["Route optimization", "Cost calculation", "Travel time estimation"],\n    "url": "https://example.com/travel-route-planner"\n  }\n]\n'})})]})}function u(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>i});var s=n(6540);const r={},a=s.createContext(r);function o(e){const t=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(a.Provider,{value:t},e.children)}}}]);